<div class="container">
  <div>
    <h1 (click)="test()">Appointment reservation</h1>
    <mat-stepper orientation="horizontal" linear="true" #stepper>
      <mat-step label="Select a date 😄" [completed]="true">
        <div class="date-selector">
          <div class="description">When would you like your appointment to take place?</div>
          <div>
            <mat-form-field class="example-full-width field" appearance="fill">
              <mat-label>Choose a date</mat-label>
              <input [min]="minDate" readonly="true" (dateChange)="DateChanged()" matInput [(ngModel)]="selectedDate" [matDatepicker]="picker">
              <mat-hint>MM/DD/YYYY</mat-hint>
              <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="buttons">
            <button mat-button matStepperNext (click)="NextClicked(0)" [disabled]="!aggregateId">Next</button>
          </div>
        </div>
      </mat-step>

      <mat-step label="Select the medical branch 🥼" [completed]="selectedBranchId !== -1">
        <p class="description">Pick one of the many specialties we offer:</p>
        <div class="card-container">
          <app-medical-branch-card *ngFor="let discipline of branches" [content]="discipline"
            [selected]="selectedBranchId === discipline.id" (click)="selectBranch(discipline.id)">
          </app-medical-branch-card>
        </div>
        <div class="buttons">
          <button mat-button matStepperPrevious (click)="BackClicked(1)">Back</button>
          <button mat-button matStepperNext [disabled]="selectedBranchId === -1" (click)="getDoctors(); NextClicked(1)">Next</button>
        </div>
      </mat-step>

      <mat-step label="Pick a doctor 👨‍⚕️" [completed]="selectedDoctorId !== -1">
        <p class="description">Pick one of our highly qualified experts:</p>
        <div *ngIf="doctors">
          <app-doctor-card *ngFor="let doctor of doctors" [doctor]="doctor" [selected]="selectedDoctorId === doctor.id"
            (click)="selectDoctor(doctor.id)"></app-doctor-card>
        </div>
        <div class="buttons">
          <button mat-button matStepperPrevious (click)="BackClicked(2)">Back</button>
          <button mat-button matStepperNext [disabled]="selectedDoctorId === -1"
            (click)="getAppointments(); ; NextClicked(2)">Next</button>
        </div>
      </mat-step>

      <mat-step label="Almost done, pick an appointment 📅" completed="false">
        <p *ngIf="appointments && !noneFound" class="description">Pick the appointment that suits you the best:</p>
        <div *ngIf="appointments && !noneFound">
          <div *ngFor="let appointment of appointments">
            <app-appointment-card [appointment]="appointment" [selected]="selectedAppointment === appointment.date"
              (click)="selectAppointment(appointment.date)"></app-appointment-card>
          </div>
        </div>
        <div class="helper" *ngIf="noneFound">
          <p>Unfortunately, no appointments seem to match you criteria 😢</p>
          <p>Would you like to:</p>
          <div class="options">
            <button mat-button (click)="pickNewDate()">Pick another date</button>
            <button mat-button (click)="pickNewDoctor()">Pick another doctor</button>
            <button mat-button (click)="toHomePage()">Go back to the home page</button>
          </div>
        </div>
        <div class="buttons" *ngIf="appointments && !noneFound">
          <button mat-button matStepperPrevious (click)="BackClicked(3)">Back</button>
          <button mat-button (click)="Schedule()">Schedule</button>
        </div>
      </mat-step>
    </mat-stepper>
  </div>
  <app-selection-info [selectedDate]="selectedDate ? selectedDate : null"
    [selectedBranch]="selectedBranch ? selectedBranch : null" [selectedDoctor]="selectedDoctor ? selectedDoctor : null"
    [selectedTime]="selectedAppointment ? selectedAppointment : null"></app-selection-info>
</div>
